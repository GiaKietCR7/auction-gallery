<%- include('partials/head', { title: 'Gallery' }) %>

<h1 class="font-serif text-3xl mb-6">Gallery</h1>

<% if (!items || !items.length) { %>
  <p class="text-ink/60">
    No items yet. <a class="link" href="/admin/upload">Upload a work</a>.
  </p>
<% } else { %>
  <div class="grid sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
    <% items.forEach(function(it){ %>
      <a href="/item/<%= it.id %>" class="block group">
        <div class="aspect-[4/3] rounded-2xl overflow-hidden shadow-card bg-mist">
          <img src="<%= getImageUrl(it.image_path) %>" alt="<%= it.title %>"
               class="w-full h-full object-cover group-hover:scale-[1.02] transition" />
        </div>
        <div class="mt-2">
          <div class="font-medium"><%= it.title %></div>
          <div class="text-[13px] text-ink/60">
            $<%= Number(it.start_price ?? 0).toFixed(2) %>
          </div>
        </div>
      </a>
    <% }) %>
  </div>
<% } %>

<% if (pager && pager.totalPages > 1) { %>
  <div class="mt-8 flex items-center justify-center gap-2">
    <% const qstr = pager.q ? ('q=' + encodeURIComponent(pager.q) + '&') : ''; %>

    <% if (pager.hasPrev) { %>
      <a class="px-3 py-1 border rounded-full hover:bg-mist"
         href="/?<%= qstr %>page=<%= pager.prev %>">‹ Prev</a>
    <% } else { %>
      <span class="px-3 py-1 border rounded-full text-ink/40">‹ Prev</span>
    <% } %>

    <% for (let i = Math.max(1, pager.page - 2); i <= Math.min(pager.totalPages, pager.page + 2); i++) { %>
      <% if (i === pager.page) { %>
        <span class="px-3 py-1 rounded-full bg-ink text-white"><%= i %></span>
      <% } else { %>
        <a class="px-3 py-1 border rounded-full hover:bg-mist"
           href="/?<%= qstr %>page=<%= i %>"><%= i %></a>
      <% } %>
    <% } %>

    <% if (pager.hasNext) { %>
      <a class="px-3 py-1 border rounded-full hover:bg-mist"
         href="/?<%= qstr %>page=<%= pager.next %>">Next ›</a>
    <% } else { %>
      <span class="px-3 py-1 border rounded-full text-ink/40">Next ›</span>
    <% } %>
  </div>
<% } %>

<%- include('partials/foot') %>
